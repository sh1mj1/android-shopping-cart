
# long-running task & thread

Î∑∞Î™®Îç∏Ïù¥ ÏïÑÎãå Í≥≥ÏóêÏÑú Ïä§Î†àÎìúÎ•º ÏÇ¨Ïö©Ìï¥Ïïº ÌïòÎäî Í≤ΩÏö∞Í∞Ä ÏûàÎã§.  
ÏòàÎ•º Îì§Ïñ¥, ÎÑ§Ìä∏ÏõåÌÅ¨ ÏöîÏ≤≠Ïù¥ÎÇò ÌååÏùº Îã§Ïö¥Î°úÎìú Îì±Ïù¥Îã§.
Ïù¥Îü∞ Í≤ΩÏö∞ÏóêÎäî ÏΩîÎ£®Ìã¥ÏùÑ ÏÇ¨Ïö©ÌïòÍ±∞ÎÇò RxJavaÎ•º ÏÇ¨Ïö©ÌïòÎäî Í≤ÉÏù¥ Ï¢ãÎã§.  
ÌïòÏßÄÎßå, ÎïåÎ°úÎäî Ïä§Î†àÎìúÎ•º ÏßÅÏ†ë Îã§Î£®Ïñ¥Ïïº ÌïòÎäî Í≤ΩÏö∞ÎèÑ ÏûàÎã§.   
Ïù¥Îü∞ Í≤ΩÏö∞ÏóêÎäî `Thread` ÌÅ¥ÎûòÏä§Î•º ÏÇ¨Ïö©ÌïòÍ±∞ÎÇò `Executor`Î•º ÏÇ¨Ïö©ÌïòÎäî Í≤ÉÏù¥ ÏùºÎ∞òÏ†ÅÏù¥Îã§.  

ÏòàÏ†ÑÏóê ÏΩîÎ£®Ìã¥ÏùÑ Í≥µÎ∂ÄÌï† Îïå RxJava Í¥ÄÎ†® Í∏ÄÏùÑ Î≥∏Ï†ÅÏù¥ ÏûàÎã§.  
Ïù¥ Îïå RxJava ÏóêÏÑúÎäî Î¨¥Ïä® callback Ïù¥ Ïñ¥Ï©åÍµ¨ Ï†ÄÏ©åÍµ¨ ÌñàÏóàÎäîÎç∞...?

Î¶¨Î∑∞Ïñ¥Ïùò Î¶¨Î∑∞  
> Ï∂îÍ∞ÄÏ†ÅÏúºÎ°ú ViewModel ÏóêÏÑú thread {} Î•º ÏÉùÏÑ±Ìï† ÌïÑÏöîÍ∞Ä ÏûàÏóàÏùÑÍπå Ïã∂ÏäµÎãàÎã§!
Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§ÎäêÎùº Îì§Ïñ¥Í∞ÄÎäî Î∂ÄÎ∂ÑÏù∏Îç∞, Ïó≠ÌôúÎ°ú ÌïòÏûêÎ©¥ DataSourceÏóê Îì§Ïñ¥Í∞ÄÏïº ÌïòÏßÄ ÏïäÏùÑÍπå ÎùºÎäî ÏÉùÍ∞ÅÏù¥ Îì≠ÎãàÎã§!ü§î

Î∑∞Î™®Îç∏ÏóêÏÑú Ïä§Î†àÎìúÎ•º ÏÉùÏÑ±ÌïòÎäî Í≤ÉÏù¥ ÎßûÎäîÏßÄÏóê ÎåÄÌïú ÏùòÎ¨∏Ïù¥ Îì†Îã§.  
Î∑∞Î™®Îç∏ÏóêÏÑú Ïä§Î†àÎìúÎ•º ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÍ≥† Ïä§Î†àÎìúÎ•º ÏÇ¨Ïö©ÌïòÎäî Í≥≥ÏùÑ ÏµúÎåÄÌïú Îã§Î•∏ Í≥ÑÏ∏µÏúºÎ°ú ÏòÆÍ∏¥Îã§Î©¥ (ÏòàÎ•º Îì§Ïñ¥ Î†àÌè¨ÏßÄÌÜ†Î¶¨ÎÇò Îç∞Ïù¥ÌÑ∞ÏÜåÏä§Î°ú) Îçî Ï¢ãÏùÄ ÏÑ§Í≥ÑÍ∞Ä Îê† Í≤É Í∞ôÎã§.  
ÏôúÎÉêÌïòÎ©¥ Î∑∞Î™®Îç∏ÏóêÏÑú Ïñ¥Îñ†Ìïú Î©îÏÑúÎìúÎ•º Ïã§ÌñâÌï† Îïå Ïù¥ Î©îÏÑúÎìúÍ∞Ä Ïä§Î†àÎìúÍ∞Ä ÌïÑÏöîÌïú ÎèôÏûëÏù∏ÏßÄ ÏïÑÎãåÏßÄÎäî Î∑∞Î™®Îç∏Ïù¥ Ïïå ÌïÑÏöîÍ∞Ä ÏóÜÎã§.  
Î∑∞Î™®Îç∏ Î©îÏÑúÎìú ÎÇ¥Î∂ÄÏóê Ïä§Î†àÎìúÎ•º Ïó¨Îäî Í≤ÉÏù¥ ÏûàÎäî Í≤ÉÏ°∞Ï∞® "Ïù¥ ÎèôÏûëÏù¥ Ïò§Îûò Í±∏Î¶¨Îäî ÎèôÏûëÏù¥Îã§, ÌòπÏùÄ Ïä§Î†àÎìúÍ∞Ä ÌïÑÏöîÌïú ÎèôÏûëÏù¥Îã§" ÎùºÎäî Ï†ïÎ≥¥Î•º ÎÖ∏Ï∂úÌïòÎäî Í≤ÉÏù¥Îã§.  

Ïó¨Îü¨ Ï†ïÎ≥¥Î•º Ï∞æÏïÑÎ≥¥ÎãàÍπå Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§Í∞Ä LiveData Î°ú Îç∞Ïù¥ÌÑ∞Î•º Í∞êÏãº ÌÉÄÏûÖÏùÑ Î¶¨ÌÑ¥ÌïòÎäî Í≤ÉÏù¥ ÏûàÎã§.  
Í∑∏Îü∞Îç∞ Ïù¥Í≤ÉÏùÄ Î≥ÑÎ°úÏù∏ Í≤É Í∞ôÎã§.  
ÏôúÎÉêÌïòÎ©¥ ÎùºÏù¥Î∏åÎç∞Ïù¥ÌÑ∞Îäî ÏïàÎìú ÌîÑÎ†àÏûÑÏõåÌÅ¨Ïóê ÏùòÏ°¥Ï†ÅÏù¥Îã§.  
Í∑∏ÎûòÏÑú Î†àÌè¨ÏßÄÌÜ†Î¶¨ÎÇò, Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§Í∞Ä Îã§Î•∏ ÌîÑÎ†àÏûÑÏõåÌÅ¨ÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÎäî ÏΩîÎìúÍ∞Ä ÎêúÎã§.  

Îã§Î•∏ ÏÜîÎ£®ÏÖòÏùÑ ÎßéÏù¥ Ï∞æÏïÑÎ≥¥ÏïòÎäîÎç∞ Ïô∏Î∂Ä ÎùºÏù¥Î∏åÎü¨Î¶¨Î•º ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏúºÎ©¥ÏÑú, ÏΩîÎ£®Ìã¥ÏùÑ ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏúºÎ©¥ÏÑúÎäî Î∑∞Î™®Îç∏ÏóêÏÑú ÏßÅÏ†ë Ïä§Î†àÎìúÎ•º ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÎäî Î∞©Î≤ïÏùÄ ÏóÜÎäî Í≤É Í∞ôÎã§.  
~~(Î¨ºÎ°† ÏûàÏùÑ ÏàòÎèÑ ÏûàÏùå. ÎÇ¥Í∞Ä Î™ª Ï∞æÏùÑ Í±∏ÏßÄÎèÑ... )~~

Í∑∏Îü∞Îç∞ callback ÏùÑ ÏÇ¨Ïö©ÌïòÎäî Í≤ÉÏù¥ ÎààÏóê ÎùàÎã§.  
Ïù¥Îü∞ ÌòïÌÉúÎ°ú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏùÑ Í≤É Í∞ôÎã§.  
```kotlin
class LocalHistoryProductDataSource(private val dao: HistoryProductDao) : ProductHistoryDataSource {

    private val executor = Executors.newFixedThreadPool(4)

    override fun saveProductHistory(productId: Long, callback: (Boolean) -> Unit) {
        executor.execute {
            val id = dao.findById(productId)

            if (id != null) {
                dao.delete(id)
            }

            dao.insert(HistoryProduct(productId))
            callback(true)
        }
    }

// ...
}
```

Ïù¥Î†áÍ≤å Ìï¥Î≥¥Ïûê.

